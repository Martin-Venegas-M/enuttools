% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/summary_testh.R
\name{summary_testh}
\alias{summary_testh}
\title{Test of Hypotheses for Complex Survey Designs}
\usage{
summary_testh(insumo, archivo_salida = "resultados_finales.xlsx")
}
\arguments{
\item{insumo}{A data frame or tibble specifying the tests to be performed.
Must include the following columns:
\describe{
  \item{cuestionario}{Specifies which survey design to use ("ch" or "cut").}
  \item{est.var}{Name of the variable to estimate (string).}
  \item{group.var}{Name of the grouping variable (string, must have exactly two levels for two-group comparisons).}
  \item{subpop}{Optional logical expression defining a subpopulation to subset.}
  \item{type.var}{Type of estimation to perform ("categorica", "nivel", "participacion", "media", "media_niveles", "prop_niveles", "tot_niveles", or "0").}
  \item{id_estimacion}{Unique identifier for naming the Excel sheet corresponding to the test.}
}}

\item{archivo_salida}{Character string. Path and filename for the output Excel file.
Defaults to `"resultados_finales.xlsx"`.}
}
\value{
The function creates an Excel workbook where each sheet contains the results of one hypothesis test.
It returns \code{NULL} (invisibly) after saving the file.
}
\description{
The function iterates over the rows of the input specification table (`insumo`),
where each row defines a hypothesis test to be performed. Each test specifies:
- the variable to be analyzed (`est.var`)
- the grouping variable (`group.var`)
- the optional subpopulation filter (`subpop`)
- and the estimation type (`type.var`).

Depending on the estimation type, the function applies the corresponding method:

\itemize{
  \item **"categorica"** — Proportion test between two groups using \code{\link[survey]{svycontrast}}.
  \item **"nivel"** — Total counts comparison between two groups using \code{svycontrast}.
  \item **"participacion"** — t-test for proportions using \code{\link[survey]{svyttest}}.
  \item **"media"** — t-test for means using \code{svyttest}.
  \item **"media_niveles"** — Comparison of means across multiple groups using \code{\link[survey]{svyglm}}.
  \item **"prop_niveles"** — Comparison of proportions across multiple groups using logistic regression with \code{svyglm(..., family = quasibinomial())}.
  \item **"tot_niveles"** — Comparison of totals across multiple groups using \code{svycontrast}.
  \item **"0"** — Skips estimation.
}

Each set of results is written to an Excel workbook (via \pkg{openxlsx}),
with one sheet per test, labeled according to the \code{id_estimacion} column in `insumo`.
}
\details{
Performs multiple types of hypothesis tests to assess statistically significant differences
(proportions, totals, means, participation rates, etc.) between groups using complex survey designs.
The results for each test are stored in an Excel file, with one sheet per estimation.


The function requires that the survey design objects \code{design_ch} and \code{design_cut}
exist in the environment before execution.
Each row of `insumo` corresponds to one hypothesis test.




The function relies on pre-defined survey design objects named `design_ch` and `design_cut`.
These must exist in the environment prior to running the function.
Each row of `insumo` represents one hypothesis test.

**Data preprocessing**

Before running the analysis, a data cleaning procedure is applied:
- Missing values, as well as responses coded as *"Don’t know"* or *"No answer"*,
  are recoded as `NA`.

**Estimation assumptions**

- When estimating proportions using `svyttest`, it is assumed that the variables
  of interest (`var_est`) are dummy variables, i.e., binary indicators taking values 0 and 1.
- Similarly, grouping variables (`group.var`) must also be binary (0/1) to ensure
  valid group comparisons.

This preprocessing step ensures that the variables are properly formatted for
statistical testing and that the results are consistent with the assumptions
of survey-based hypothesis testing.


Internally, the function:
\enumerate{
  \item Selects the appropriate survey design (\code{design_ch} or \code{design_cut}).
  \item Applies the optional subpopulation filter (if defined in `subpop`).
  \item Runs the statistical test based on the \code{type.var} value.
  \item Extracts the estimates, standard errors, t-values, degrees of freedom, and p-values.
  \item Evaluates statistical significance (p < 0.05 = "Significativa").
  \item Exports the summarized results to the Excel file defined in \code{archivo_salida}.
}
}
\section{Assumptions}{

- Variables used in \code{participacion} or \code{prop_niveles} tests are binary (0/1).
- Grouping variables must have exactly two categories for two-group tests.
- The user must ensure that the survey design objects (\code{design_ch}, \code{design_cut}) are properly defined.
}

