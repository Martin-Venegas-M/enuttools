% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fast_survey_design.R
\name{fast_survey_design}
\alias{fast_survey_design}
\title{Quickly create a survey design object from raw data}
\usage{
fast_survey_design(
  data,
  ids = "varunit",
  strata = "varstrat",
  pop = TRUE,
  transform.missings = TRUE,
  cols.transform = everything(),
  missing.code = -777,
  ...
)
}
\arguments{
\item{data}{A data frame or tibble containing the survey data.}

\item{ids}{Variable indicating the primary sampling units (PSUs).
Defaults to \code{"varunit"}. Can be provided unquoted using tidy evaluation.}

\item{strata}{Variable indicating strata identifiers.
Defaults to \code{"varstrat"}. Can also be provided unquoted using tidy evaluation.}

\item{pop}{Logical expression (tidy-evaluation style) defining the subpopulation
to include in the design. Defaults to \code{TRUE} (include all observations).}

\item{transform.missings}{Logical; if \code{TRUE}, recodes all occurrences of
\code{missing.code} as \code{NA} in the columns specified by \code{cols.transform}.
Default is \code{TRUE}.}

\item{cols.transform}{Column selection (tidyselect syntax) to apply missing
transformation. Defaults to \code{everything()}.}

\item{missing.code}{Numeric or character value used in the dataset to represent
missing values. Default is \code{-777}.}

\item{...}{Additional arguments passed to \code{srvyr::as_survey_design()}, such as
weights, finite population correction, or nesting options.}
}
\value{
An object of class \code{srvyr::tbl_svy}, ready for use with \pkg{srvyr} verbs such as
\code{summarise()}, \code{mutate()}, \code{group_by()}, and survey estimation functions like
\code{survey_mean()} or \code{survey_total()}.
}
\description{
This function streamlines the process of defining a complex survey design.
It can:
\itemize{
  \item Transform a user-specified missing-value code (e.g., \code{-777}) into \code{NA};
  \item Filter the dataset by a logical condition defining the population of interest;
  \item Create a survey design object with clustering and stratification variables.
}
}
\details{
Helper function to efficiently create a \code{srvyr::tbl_svy} survey design object
from a data frame. It optionally converts custom missing-value codes to \code{NA},
filters the dataset by a target population, and defines cluster and strata
identifiers.


The function performs the following steps:
\enumerate{
  \item If \code{transform.missings = TRUE}, converts all \code{missing.code} values in
        the selected columns into \code{NA}.
  \item Filters the data using the logical expression provided in \code{pop}.
  \item Constructs the survey design object using \code{srvyr::as_survey_design()}
        with the specified identifiers and additional parameters.
}

This function is intended as a quick wrapper for building survey designs when
working with complex survey microdata (e.g., household surveys or labor force
data) and integrating it into reproducible workflows.
}
\examples{
\dontrun{
# Basic usage: create survey design from data
svy <- fast_survey_design(
  data = mydata,
  ids = varunit,
  strata = varstrat,
  weights = wgt
)

# Convert missing codes (-777) to NA only in numeric columns
svy <- fast_survey_design(
  data = mydata,
  cols.transform = where(is.numeric),
  missing.code = -777
)

# Define a subpopulation (e.g., only adults)
svy <- fast_survey_design(
  data = mydata,
  pop = age >= 18
)
}

}
\seealso{
\code{\link[srvyr]{as_survey_design}}, \code{\link[dplyr]{mutate}},
  \code{\link[dplyr]{across}}, \code{\link[dplyr]{filter}}.
}
